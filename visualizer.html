<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>React Profiler Visualizer</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="visualizer.css">
</head>
<body>
    <div class="header">
        <h1>React Profiler Visualizer</h1>
        <p>Analyze and compare the performance of your React components</p>
    </div>

    <div class="file-loaders">
        <div class="file-loader before" onclick="document.getElementById('file-before').click()">
            <input type="file" id="file-before" accept=".json" onchange="loadFile(this, 'before')">
            <h3>Before (Non-optimized)</h3>
            <p>Drag or click to load profiler</p>
            <div class="status" id="status-before"></div>
        </div>
        <div class="file-loader after" onclick="document.getElementById('file-after').click()">
            <input type="file" id="file-after" accept=".json" onchange="loadFile(this, 'after')">
            <h3>After (Optimized)</h3>
            <p>Drag or click to load profiler</p>
            <div class="status" id="status-after"></div>
        </div>
    </div>

    <div class="tabs">
        <div class="tab active" onclick="switchTab('overview')">Overview</div>
        <div class="tab" onclick="switchTab('components')">Components</div>
        <div class="tab" onclick="switchTab('rerenders')">Re-renders</div>
        <div class="tab" onclick="switchTab('timeline')">Timeline</div>
        <div class="tab" onclick="switchTab('comparison')">Comparison</div>
    </div>

    <div id="overview" class="content active">
        <div class="empty-state" id="overview-empty">
            <h3>Load at least one profiler file</h3>
            <p>Select JSON files exported from React DevTools</p>
        </div>
        <div id="overview-content" style="display: none;">
            <div class="summary-grid" id="summary-grid"></div>
            <div class="two-columns">
                <div class="panel">
                    <div class="panel-header">
                        <h3>Time Distribution per Commit</h3>
                    </div>
                    <div class="panel-body">
                        <div class="chart-container">
                            <canvas id="commitDurationChart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="panel">
                    <div class="panel-header">
                        <h3>Re-render Reasons (Global)</h3>
                    </div>
                    <div class="panel-body">
                        <div class="chart-container">
                            <canvas id="rerenderReasonsChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="components" class="content">
        <div class="empty-state" id="components-empty">
            <h3>Load at least one profiler file</h3>
            <p>See which components render the most</p>
        </div>
        <div id="components-content" style="display: none;">
            <div class="filter-bar">
                <input type="text" id="component-filter" placeholder="Filter components..." oninput="filterComponents()">
                <select id="component-sort" onchange="sortComponents()">
                    <option value="renders">Sort by renders</option>
                    <option value="duration">Sort by duration</option>
                    <option value="improvement">Sort by improvement</option>
                    <option value="name">Sort by name</option>
                </select>
            </div>
            <div class="panel">
                <div class="panel-header">
                    <h3>Top Components by Render Count</h3>
                    <span id="component-count"></span>
                </div>
                <div class="panel-body" id="components-list"></div>
            </div>
        </div>
    </div>

    <div id="rerenders" class="content">
        <div class="empty-state" id="rerenders-empty">
            <h3>Load at least one profiler file</h3>
            <p>Analyze the causes of re-renders</p>
        </div>
        <div id="rerenders-content" style="display: none;">
            <div class="filter-bar">
                <input type="text" id="rerender-filter" placeholder="Filter components..." oninput="filterRerenders()">
            </div>
            <div class="panel">
                <div class="panel-header">
                    <h3>Components and their Re-render Causes</h3>
                </div>
                <div class="panel-body" id="rerenders-list"></div>
            </div>
        </div>
    </div>

    <div id="timeline" class="content">
        <div class="empty-state" id="timeline-empty">
            <h3>Load at least one profiler file</h3>
            <p>Visualize the render timeline</p>
        </div>
        <div id="timeline-content" style="display: none;">
            <div class="panel">
                <div class="panel-header">
                    <h3>Commit Duration Over Time</h3>
                </div>
                <div class="panel-body">
                    <div class="chart-container" style="height: 400px;">
                        <canvas id="timelineChart"></canvas>
                    </div>
                    <div class="legend">
                        <div class="legend-item">
                            <div class="legend-color" style="background: #f85149;"></div>
                            <span>Non-optimized</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #3fb950;"></div>
                            <span>Optimized</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="panel">
                <div class="panel-header">
                    <h3>Scheduling Events</h3>
                </div>
                <div class="panel-body" id="scheduling-events"></div>
            </div>
        </div>
    </div>

    <div id="comparison" class="content">
        <div class="empty-state" id="comparison-empty">
            <h3>Load both files to compare</h3>
            <p>You need before and after to see the comparison</p>
        </div>
        <div id="comparison-content" style="display: none;">
            <div class="summary-grid" id="comparison-summary"></div>
            <div class="panel">
                <div class="panel-header">
                    <h3>Improvement/Regression per Component</h3>
                </div>
                <div class="panel-body">
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Component</th>
                                <th>Renders Before</th>
                                <th>Renders After</th>
                                <th>Difference</th>
                                <th>% Change</th>
                            </tr>
                        </thead>
                        <tbody id="comparison-table-body"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="visualizer.js"></script>
</body>
</html>
